{"ast":null,"code":"import _defineProperty from\"D:/CFD/react JS/react-cfd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"D:/CFD/react JS/react-cfd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"D:/CFD/react JS/react-cfd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from\"react\";var emailPattern=/^[a-z][a-z0-9_\\.]{2,32}@[a-z0-9]{2,}(\\.[a-z0-9]{2,4}){1,2}$/i,phonePattern=/(84|0[3|5|7|8|9])+([0-9]{8})\\b/i,urlPattern=/^(?:http(s)?:\\/\\/)?[\\w.-]+(?:\\.[\\w\\.-]+)+[\\w\\-\\._~:/?#[\\]@!\\$&'\\(\\)\\*\\+,;=.]+$/i;export default function useFormValidate(initialForm,validate){var rule=validate.rule,message=validate.message,options=validate.options;if(!options)options={};var v=initialForm;if(options.localStorage){v=JSON.parse(localStorage.getItem(options.localStorage))||initialForm;}var _useState=useState(v),_useState2=_slicedToArray(_useState,2),form=_useState2[0],setForm=_useState2[1];useEffect(function(){if(options.localStorage){localStorage.setItem(options.localStorage,JSON.stringify(form));return function(){localStorage.removeItem(options.localStorage);};}},[form]);var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];function inputChange(e){var name=e.target.name;var value=e.target.value;var type=e.target.type;if(type==='checkbox'){value=e.target.checked;}setForm(_objectSpread(_objectSpread({},form),{},_defineProperty({},name,value)));}function check(){var errorObj={};for(var i in rule){var r=rule[i];var m=(message===null||message===void 0?void 0:message[i])||null;if(r.required&&!form[i]){errorObj[i]=(m===null||m===void 0?void 0:m.required)||\" không được để trống\";}if(r.pattern&&form[i]){var pattern=r.pattern;if(pattern==='email')pattern=emailPattern;if(pattern==='phone')pattern=phonePattern;if(r.pattern==='url')pattern=urlPattern;try{if(!pattern.test(form[i])){errorObj[i]=(m===null||m===void 0?void 0:m.pattern)||\"Không đúng định dạng\";}}catch(err){errorObj[i]=\"lỗi định dạng\";}if(r.min&&form[i].length<r.min){errorObj[i]=(m===null||m===void 0?void 0:m.min)||\"Tr\\u01B0\\u1EDDng n\\xE0y kh\\xF4ng \\u0111\\u01B0\\u1EE3c \\xEDt h\\u01A1n \".concat(r.min,\" k\\xFD t\\u1EF1\");}if(r.max&&form[i].length>r.max){errorObj[i]=(m===null||m===void 0?void 0:m.max)||\"Tr\\u01B0\\u1EDDng n\\xE0y kh\\xF4ng \\u0111\\u01B0\\u1EE3c l\\u1EDBn h\\u01A1n \".concat(r.max,\" k\\xFD t\\u1EF1\");}}}setError(errorObj);return errorObj;}return{form:form,error:error,inputChange:inputChange,check:check,setForm:setForm};}","map":{"version":3,"sources":["D:/CFD/react JS/react-cfd/src/core/useFormValidate.jsx"],"names":["useEffect","useState","emailPattern","phonePattern","urlPattern","useFormValidate","initialForm","validate","rule","message","options","v","localStorage","JSON","parse","getItem","form","setForm","setItem","stringify","removeItem","error","setError","inputChange","e","name","target","value","type","checked","check","errorObj","i","r","m","required","pattern","test","err","min","length","max"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\r\n\r\nlet emailPattern = /^[a-z][a-z0-9_\\.]{2,32}@[a-z0-9]{2,}(\\.[a-z0-9]{2,4}){1,2}$/i,\r\n    phonePattern = /(84|0[3|5|7|8|9])+([0-9]{8})\\b/i,\r\n    urlPattern = /^(?:http(s)?:\\/\\/)?[\\w.-]+(?:\\.[\\w\\.-]+)+[\\w\\-\\._~:/?#[\\]@!\\$&'\\(\\)\\*\\+,;=.]+$/i;\r\n\r\nexport default function useFormValidate(initialForm, validate) {\r\n\r\n    let { rule, message, options } = validate;\r\n\r\n    if (!options) options = {};\r\n\r\n    let v = initialForm;\r\n    if (options.localStorage) {\r\n        v = JSON.parse(localStorage.getItem(options.localStorage)) || initialForm\r\n    }\r\n    let [form, setForm] = useState(v)\r\n\r\n    useEffect(() => {\r\n\r\n        if (options.localStorage) {\r\n            localStorage.setItem(options.localStorage, JSON.stringify(form))\r\n            return () => {\r\n                localStorage.removeItem(options.localStorage)\r\n            }\r\n        }\r\n\r\n    }, [form])\r\n\r\n    let [error, setError] = useState({\r\n\r\n    })\r\n\r\n\r\n    function inputChange(e) {\r\n        let name = e.target.name\r\n        let value = e.target.value\r\n        let type = e.target.type\r\n\r\n\r\n        if (type === 'checkbox') {\r\n            value = e.target.checked\r\n        }\r\n\r\n\r\n        setForm({\r\n            ...form,\r\n            [name]: value,\r\n\r\n        })\r\n    }\r\n    function check() {\r\n        let errorObj = {}\r\n\r\n        for (let i in rule) {\r\n            let r = rule[i]\r\n            let m = message?.[i] || null\r\n\r\n            if (r.required && !form[i]) {\r\n                errorObj[i] = m?.required || \" không được để trống\"\r\n            }\r\n\r\n            if (r.pattern && form[i]) {\r\n                let pattern = r.pattern\r\n                if (pattern === 'email') pattern = emailPattern\r\n                if (pattern === 'phone') pattern = phonePattern\r\n                if (r.pattern === 'url') pattern = urlPattern\r\n\r\n\r\n\r\n                try {\r\n                    if (!pattern.test(form[i])) {\r\n                        errorObj[i] = m?.pattern || \"Không đúng định dạng\"\r\n                    }\r\n                } catch (err) {\r\n                    errorObj[i] = \"lỗi định dạng\"\r\n                }\r\n\r\n                if (r.min && form[i].length < r.min) {\r\n                    errorObj[i] = m?.min || `Trường này không được ít hơn ${r.min} ký tự`\r\n                }\r\n                if (r.max && form[i].length > r.max) {\r\n                    errorObj[i] = m?.max || `Trường này không được lớn hơn ${r.max} ký tự`\r\n                }\r\n\r\n\r\n            }\r\n        }\r\n\r\n        setError(errorObj)\r\n        return (errorObj)\r\n    }\r\n\r\n    return {\r\n        form, error, inputChange, check, setForm\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}